
%_____________________________________________________________
clear all;
h=1e-3;
N=1/h;
y0(1)=0;
for n=1:N
    t=n*h;
    y0(n)=(t^3+3*t)/(3*(t^2 + 1));
end
y0(N)

%_____________________________________________________________
%RK3
clear y;
K1=f_751(0,0);
K2=f_751(0+h/2,0+h*K1/2);
K3=f_751(0+3*h/4,0+3*h*K2/4);
y(1)=0+h*(2*K1+3*K2+4*K3)/9;

for n=1:(N-1)
    t=n*h;
    K1=f_751(t,y(n));
    K2=f_751(t+h/2,y(n)+h*K1/2);
    K3=f_751(t+3*h/4,y(n)+3*h*K2/4);
    y(n+1)=y(n)+h*(2*K1+3*K2+4*K3)/9;
end
% p3=plot(h:h:1,-log(abs(y-y0)))
% saveas(p3,'7553','jpg')
% close
y(N)

h1=h/2;
N1=1/h1;

K1=f_751(0,0);
K2=f_751(0+h1/2,0+h1*K1/2);
K3=f_751(0+3*h1/4,0+3*h1*K2/4);
y1(1)=0+h1*(2*K1+3*K2+4*K3)/9;

for n=1:(N1-1)
    t=n*h1;
    K1=f_751(t,y1(n));
    K2=f_751(t+h1/2,y1(n)+h1*K1/2);
    K3=f_751(t+3*h1/4,y1(n)+3*h1*K2/4);
    y1(n+1)=y1(n)+h1*(2*K1+3*K2+4*K3)/9;
end

y1(N1)

for n=1:N
    delta2(n)=abs(y(n)-y0(n))/abs(y1(2*n)-y0(n));
end
abs(y(n)-y0(n))
abs(y1(2*n)-y0(n))
delta2=log2(delta2);
plot(h:h:1,delta2)
% axis([0 1 1.9999 2.0001])
saveas(gca,'755_RK3_alpha','jpg');





