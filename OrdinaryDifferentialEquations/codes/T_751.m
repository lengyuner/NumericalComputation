
%_____________________________________________________________
clear all;
h=1e-3;
N=1/h;
y0(1)=0;
for n=1:N
    t=n*h;
    y0(n)=(t^3+3*t)/(3*(t^2 + 1));
end
p0=plot(h:h:1,y0);
saveas(p0,'7510','jpg');
close;
y0(N)

% %_____________________________________________________________
% %   Euler 
% t=0;
% y(1)=0+h*f_751(t,0);
% for n=1:(N-1)
%     t=n*h;
%     y(n+1)=y(n)+h*f_751(t,y(n));
% end
% p1=plot(h:h:1,-log(abs(y-y0)));
% % p1=plot(h:h:1,-log(abs(y-y0)))
% saveas(p1,'7511','jpg')
% close
% y(N)










% %_____________________________________________________________
% %   ti xing fa
% clear y;
% t=0;
% y02=0+h*f_751(t,0);
% y(1)=0+h*(f_751(t,0)+f_751(t+h,y02))/2;
% for n=1:(N-1)
%     t=n*h;
%     y02=y(n)+h*f_751(t,y(n));
%     y(n+1)=y(n)+h*(f_751(t,y(n))+f_751(t+h,y02))/2;
% end
% p2=plot(h:h:1,-log(abs(y-y0)));
% saveas(p2,'7512','jpg')
% close
% y(N)



% %_____________________________________________________________
% %RK3
% clear y;
% t=0;
% K1=f_751(t,0);
% K2=f_751(t+h/2,0+h*K1/2);
% K3=f_751(t+3*h/4,0+3*h*K2/4);
% y(1)=0+h*(2*K1+3*K2+4*K3)/9;
% for n=1:(N-1)
%     t=n*h;
%     K1=f_751(t,y(n));
%     K2=f_751(t+h/2,y(n)+h*K1/2);
%     K3=f_751(t+3*h/4,y(n)+3*h*K2/4);
%     y(n+1)=y(n)+h*(2*K1+3*K2+4*K3)/9;
% end
% p3=plot(h:h:1,-log(abs(y-y0)));
% saveas(p3,'7513','jpg')
% close
% y(N)









% %_____________________________________________________________
% %RK4
% clear y;
% t=0;
%     K1=f_751(t,0);
%     K2=f_751(t+h/2,0+h*K1/2);
%     K3=f_751(t+h/2,0+h*K2/2);
%     K4=f_751(t+h,0+h*K3);
%     y(1)=0+h*(K1+2*K2+2*K3+K4)/6;
% for n=1:(N-1)
%     t=n*h;
%     K1=f_751(t,y(n));
%     K2=f_751(t+h/2,y(n)+h*K1/2);
%     K3=f_751(t+h/2,y(n)+h*K2/2);
%     K4=f_751(t+h,y(n)+h*K3);
%     y(n+1)=y(n)+h*(K1+2*K2+2*K3+K4)/6;
% end
% plot(h:h:1,y)
% p4=plot(h:h:1,-log(abs(y-y0)));
% saveas(p4,'7514','jpg')
% close
% y(N)










%_____________________________________________________________
%Adams(3,3)
clear y;

t=0;
K1=f_751(t,0);
K2=f_751(t+h/2,0+h*K1/2);
K3=f_751(t+h/2,0+h*K2/2);
K4=f_751(t+h,0+h*K3);
fn0=(K1+2*K2+2*K3+K4)/6;
y(1)=0+h*fn0;
for n=1:3
    t=n*h;
    K1=f_751(t,y(n));
    K2=f_751(t+h/2,y(n)+h*K1/2);
    K3=f_751(t+h/2,y(n)+h*K2/2);
    K4=f_751(t+h,y(n)+h*K3);
    fn(n)=(K1+2*K2+2*K3+K4)/6;
    y(n+1)=y(n)+h*fn(n);
end
for n=3:(N-1)
    t=n*h;
    fn(n)=f_751(t,y(n));
%     y05=y(n)+h*(23*fn(n)-16*fn(n-1)+5*fn(n-2))/12;
%     y(n+1)=y(n)+h*(9*f_751(t,y05)+19*fn(n)-5*fn(n-1)+fn(n-2))/24;
    y(n+1)=y(n)+h*(23*fn(n)-16*fn(n-1)+5*fn(n-2))/12;
end
p5=plot(h:h:1,-log(abs(y-y0)));
saveas(p5,'7515','jpg')
%close
y(N)




